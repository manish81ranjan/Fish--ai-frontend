<!DOCTYPE html>
<html>

<head>
  <title>Secure Checkout</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-950 text-white">

  <nav class="bg-cyan-600 p-4 text-lg font-bold">ðŸ’³ Secure Checkout</nav>

  <div class="max-w-md mx-auto mt-10 bg-slate-900 p-6 rounded-xl border border-cyan-400">

    <h2 class="text-xl mb-4 text-cyan-400">Order Summary</h2>
    <div id="items" class="space-y-3"></div>

    <div class="border-t border-slate-700 mt-4 pt-4 text-right">
      <h3 class="text-xl">Total: <span id="total" class="text-cyan-400">â‚¹0</span></h3>
    </div>

    <button onclick="payNow()" class="mt-4 w-full bg-green-500 py-3 rounded font-bold hover:opacity-90">
      Pay Securely
    </button>
  </div>

  <script>
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const itemsBox = document.getElementById("items");
    const totalBox = document.getElementById("total");
    let total = 0;

    // Render checkout items
    if (cart.length === 0) {
      itemsBox.innerHTML = "<p class='text-center text-gray-400'>Cart Empty</p>";
    } else {
      cart.forEach(p => {
        let price = Number(p.price);
        let qty = Number(p.qty);
        let lineTotal = price * qty;
        total += lineTotal;

        itemsBox.innerHTML += `
      <div class="flex justify-between">
        <span>${p.name} Ã— ${qty}</span>
        <span class="text-cyan-400">â‚¹${lineTotal.toFixed(2)}</span>
      </div>`;
      });
      totalBox.innerText = "â‚¹" + total.toFixed(2);
    }

    // Fake payment
    function payNow() {
      if (!cart.length) return alert("Cart Empty");

      const orders = JSON.parse(localStorage.getItem("orders")) || [];

      const newOrder = {
        id: Date.now(),
        date: new Date().toISOString().split('T')[0],
        items: cart.map(p => ({
          name: p.name,
          quantity: Number(p.qty),
          price: Number(p.price)
        })),
        total: Number(total.toFixed(2)),   // <<< FIXED HERE
        status: "completed"
      };

      orders.push(newOrder);
      localStorage.setItem("orders", JSON.stringify(orders));
      localStorage.removeItem("cart");

      alert("Payment Successful!");
      window.location.href = "/orders.html";
    }
  </script>


</body>

</html>